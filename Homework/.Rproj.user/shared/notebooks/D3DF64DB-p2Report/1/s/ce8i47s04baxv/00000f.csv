"0","import yfinance as yf"
"0","from datetime import datetime"
"0","import pandas as pd"
"0",""
"0",""
"0","# Ticker & Metric list"
"0","tickers = ['NVDA', 'COST', 'AMZN', 'INLF', 'WMT', 'JNJ', 'UNH', 'ZSPC']"
"0","#metrics = ['_Close', '_Open', '_Low', '_High', '_Volume']"
"0",""
"0","#Uses most Recent Date"
"0","end_date = datetime.today().strftime('%Y-%m-%d')"
"0",""
"0","#Downloading tickr history from yahoo finance (yf)"
"0","data = yf.download(tickers, end=end_date, interval='1d', group_by='ticker')"
"2","[                       0%                       ]"
"2","[************          25%                       ]  2 of 8 completed"
"2","[******************    38%                       ]  3 of 8 completed"
"2","[**********************50%                       ]  4 of 8 completed"
"2","[**********************62%*****                  ]  5 of 8 completed"
"2","[**********************75%***********            ]  6 of 8 completed"
"2","[**********************88%*****************      ]  7 of 8 completed"
"2","[*********************100%***********************]  8 of 8 completed
"
"0","#downloading raw data"
"0","data.to_csv('unclean_stocks.csv')"
"0",""
"0",""
"0","#flattening column multi-index"
"0","data.columns = [f""{metric}_{ticker}"" for metric, ticker in data.columns]"
"0",""
"0","#date becomes a regular column"
"0","data = data.reset_index()"
"0",""
"0","# Pivoting data into longer format (like pivot_longer() in R)"
"0","data = data.melt(id_vars=""Date"", var_name=""Metric_Ticker"", value_name=""Price"")"
"0",""
"0","#Splitting columns with expand=TRUE and str.split()"
"0","data[['Ticker', 'Metric']] = data['Metric_Ticker'].str.split('_', expand=True)"
"0",""
"0","#Dropping the original combined column"
"0","data = data.drop(columns='Metric_Ticker')"
"0",""
"0","#expansion of metrics for visulization"
"0","data = data.pivot(index=[""Date"", ""Ticker""], columns=""Metric"", values=""Price"").reset_index()"
"0",""
"0","#R data"
"0","data.to_csv('stocks.csv', index=False)"
"0",""
"0",""
